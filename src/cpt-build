#!/bin/sh
# Build a package

# shellcheck disable=1091
if command -v cpt-lib >/dev/null; then . cpt-lib; else . ./cpt-lib; fi

eval set -- "$(getopt -l no-prompt,version,help -- yvh "$@")"
while :; do
    case "$1" in
        --help|-h)
            out "usage: ${0##*/} [pkg...]" "" \
                "  Options:" \
                "  -y --no-prompt  Do not prompt for confirmation"
            exit 1 ;;
        --version|-v) version ;;
        --no-prompt|-y) export CPT_PROMPT=0; shift ;;
        --) shift; break ;;
    esac
done

[ "$1" ] || set -- "${PWD##*/}"; export CPT_PATH=${PWD%/*}:$CPT_PATH

create_cache

pkg_build "$@"
